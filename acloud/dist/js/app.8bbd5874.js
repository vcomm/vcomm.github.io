(function(e){function t(t){for(var o,a,c=t[0],r=t[1],l=t[2],d=0,f=[];d<c.length;d++)a=c[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&f.push(s[a][0]),s[a]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,c=1;c<n.length;c++){var r=n[c];0!==s[r]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},s={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/acloud/dist/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=r;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("VideoArea",{directives:[{name:"show",rawName:"v-show",value:e.isVideo&&e.isChatOpen&&e.contact,expression:"isVideo && isChatOpen && contact"}]}),n("beautiful-chat",{attrs:{alwaysScrollToBottom:e.alwaysScrollToBottom,close:e.closeChat,colors:e.colors,isOpen:e.isChatOpen,messageList:e.messageList,messageStyling:e.messageStyling,newMessagesCount:e.newMessagesCount,onMessageWasSent:e.onMessageWasSent,open:e.openChat,title:e.title,participants:e.participants,showCloseButton:!1,showLauncher:!0,showEmoji:!0,showFile:!0,showHeader:!0,showTypingIndicator:e.showTypingIndicator,showEdition:!0,showDeletion:!0,showConfirmationDeletion:!0,confirmationDeletionMessage:"Are you sure? (you can customize this message)",titleImageUrl:e.titleImageUrl,disableUserListToggle:!1},on:{onType:e.handleOnType,edit:e.editMessage,remove:e.removeMessage},scopedSlots:e._u([{key:"header",fn:function(){return[n("fieldset",[n("div",{staticClass:"navigation",class:{change:e.isVideo&&e.contact},on:{click:function(t){e.inCall?e.callOff():e.callOn()}}},[n("div",{staticClass:"bar1"}),n("div",{staticClass:"bar2"}),n("div",{staticClass:"bar3"})])]),n("fieldset",[n("div",{staticClass:"select"},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.contact,expression:"contact"}],attrs:{required:!0},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.contact=t.target.multiple?n:n[0]},function(t){return e.onSelect(t)}]}},[n("optgroup",{attrs:{label:"Team contacts"}}),n("optgroup",{attrs:{label:"Guest contacts"}},e._l(e.participants,(function(t,o){return n("option",{key:o,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),0)])])])]},proxy:!0}])})],1)},i=[],a=(n("99af"),n("7db0"),n("4160"),n("d3b7"),n("25f0"),n("4d90"),n("159b"),n("2909")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"vmodule",staticClass:"video",on:{click:function(t){return e.pipVideo()}}},[n("video",{ref:"remotevideo",staticClass:"remote",attrs:{id:"remotevideo",autoplay:"",poster:"/images/logo.jpg"}}),n("video",{ref:"localVideo",staticClass:"local",attrs:{id:"localVideo",autoplay:"",poster:"/images/logo.jpg"},on:{click:function(t){return e.toggleLocalVideo()}}})])},r=[],l={name:"VideoArea",data:function(){return{vModule:{},remVideo:{},locVideo:{},remStream:void 0,locStream:void 0}},methods:{toggleLocalVideo:function(e){var t=this;this.locStream?(this.locStream.getTracks().forEach((function(t){switch(e){case"video":"live"==t.readyState&&"video"===t.kind&&t.stop();break;case"audio":"live"==t.readyState&&"audio"===t.kind&&t.stop();break;default:"live"==t.readyState&&t.stop()}})),this.locStream=void 0):"mediaDevices"in navigator&&navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(e){t.locStream=e,console.log("Got local stream:"),document.querySelector("#localVideo").srcObject=e})).catch((function(e){console.log("Failed to get local stream",e)}))},dragModule:function(e){var t=this;this.vModule=e;var n=0,o=0,s=0,i=0;this.vModule.onmousedown=function(e){e=e||window.event,e.preventDefault(),s=e.clientX,i=e.clientY,document.onmouseup=function(){document.onmouseup=null,document.onmousemove=null},document.onmousemove=function(e){e=e||window.event,e.preventDefault(),n=s-e.clientX,o=i-e.clientY,s=e.clientX,i=e.clientY,t.vModule.style.top=t.vModule.offsetTop-o+"px",t.vModule.style.left=t.vModule.offsetLeft-n+"px"}}},pipVideo:function(){document.pictureInPictureElement?document.exitPictureInPicture().catch((function(e){console.log("Error exitPictureInPicture",e)})):this.remVideo.requestPictureInPicture().catch((function(e){console.log("Error requestPictureInPicture",e)}))}},created:function(){console.log("Created")},mounted:function(){this.dragModule(this.$refs.vmodule),this.remVideo=this.$refs.remotevideo,this.locVideo=this.$refs.localvideo,document.addEventListener("click",(function(e){}))}},u=l,d=(n("faa2"),n("2877")),f=Object(d["a"])(u,c,r,!1,null,"c6f0c6a8",null),h=f.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-list"},[e._v(" Side Menu ")])},g=[],m={props:{},computed:{userListColor:function(){var e={userList:{bg:"#FFFFFF",text:"#000000"}};return Object.assign(e,this.colors)}}},v=m,y=(n("aa28"),Object(d["a"])(v,p,g,!1,null,"668f4f8c",null)),b=y.exports,C={red:{header:{bg:"#D32F2F",text:"#fff"},launcher:{bg:"#D32F2F"},messageList:{bg:"#fff"},sentMessage:{bg:"#F44336",text:"#fff"},receivedMessage:{bg:"#eaeaea",text:"#222222"},userInput:{bg:"#fff",text:"#212121"},userList:{bg:"#fff",text:"#212121"}},green:{header:{bg:"#388E3C",text:"#fff"},launcher:{bg:"#388E3C"},messageList:{bg:"#fff"},sentMessage:{bg:"#4CAF50",text:"#fff"},receivedMessage:{bg:"#eaeaea",text:"#222222"},userInput:{bg:"#fff",text:"#212121"},userList:{bg:"#fff",text:"#212121"}},blue:{header:{bg:"#4e8cff",text:"#ffffff"},launcher:{bg:"#4e8cff"},messageList:{bg:"#ffffff"},sentMessage:{bg:"#4e8cff",text:"#ffffff"},receivedMessage:{bg:"#eaeaea",text:"#222222"},userInput:{bg:"#f4f7f9",text:"#565867"},userList:{bg:"#fff",text:"#212121"}},dark:{header:{bg:"#34495e",text:"#ecf0f1"},launcher:{bg:"#34495e"},messageList:{bg:"#ffffff"},sentMessage:{bg:"#7f8c8d",text:"#ecf0f1"},receivedMessage:{bg:"#95a5a6",text:"#ecf0f1"},userInput:{bg:"#34495e",text:"#ecf0f1"},userList:{bg:"#fff",text:"#212121"}}},w=n("d4ec"),x=n("bee2"),O=n("262e"),M=n("2caf"),S=n("a0bc"),P=n.n(S),L=function(e){Object(O["a"])(n,e);var t=Object(M["a"])(n);function n(e,o,s){var i;return Object(w["a"])(this,n),console.log("Connect to ".concat(o.host,":").concat(o.port)),i=t.call(this,e,o),i.connecters={},i.constraints={audio:!1,video:{width:{min:320,ideal:1280,max:1920},height:{min:240,ideal:720,max:1080}}},i.peerNotify=s||null,i.on("open",(function(e){console.log("My peer ID is: "+e),i.listAllPeers((function(e){console.log("Connected peers: ",e),i.peerNotify&&i.peerNotify.hasOwnProperty("peers")&&i.peerNotify["peers"](e)}))})),i.on("error",(function(e){console.error(e)})),i.on("connection",(function(e){console.log("incoming peer connection!"),e.on("data",(function(e){console.log("received:",e),i.peerNotify&&i.peerNotify.hasOwnProperty("data")&&i.peerNotify["data"](e)})),e.on("open",(function(e){console.log("Open connection:",e)})),e.on("close",(function(){console.log("Close connection:")}))})),i.on("disconnected",(function(){console.log("Disconected connection:")})),i.on("close",(function(){console.log("Close connection:")})),i.on("call",(function(e){navigator.mediaDevices.getUserMedia(i.constraints).then((function(t){i.peerNotify["stream"](t,"localVideo"),e.answer(t),i.peerNotify["call"](e,"answer"),e.on("stream",(function(t){i.peerNotify["stream"](t,"remotevideo"),i.connecters[e.peer].call=e})).on("close",(function(){console.log("Media call closed"),i.connecters[e.peer].call=void 0})).on("error",(function(){console.error("Failed media call",err),i.connecters[e.peer].call=void 0}))})).catch((function(e){console.error("Failed to get local stream",e)}))})),i}return Object(x["a"])(n,[{key:"connToPeer",value:function(e){var t=this;return console.log("Connecting to ".concat(e,"...")),new Promise((function(n,o){var s=t.connect(e);s.on("data",(function(e){console.log("received: ",e),t.peerNotify&&t.peerNotify.hasOwnProperty("data")&&t.peerNotify["data"](e)})),s.on("open",(function(){console.log("Add ".concat(e," connecter to pool")),t.connecters[e]={conn:s},n(s)})),s.on("close",(function(){t.connecters.hasOwnProperty(e)&&(console.log("Remove ".concat(e," connecter from pool")),delete t.connecters[e])})),s.on("error",(function(e){o(e)}))})).then((function(e){return e})).catch((function(e){console.error("Failed connecting",e)}))}},{key:"msgToPeer",value:function(e,t){console.log("Sending msg => ".concat(t),e),this.connecters.hasOwnProperty(t)?this.connecters[t].conn.send(e):this.connToPeer(t).then((function(t){t.send(e)}))}},{key:"callToPeer",value:function(e){var t=this;console.log("Calling to ".concat(e)),this.connecters.hasOwnProperty(e)?this.mediaConnection(e,this.connecters[e].conn):this.connToPeer(e).then((function(n){t.mediaConnection(e,n)}))}},{key:"hangUpPeer",value:function(e){console.log("HangUp ".concat(e," peer")),this.connecters.hasOwnProperty(e)&&(this.connecters[e].conn.send({author:this.id,type:"text",data:{text:"HangUp media connection..."}}),this.connecters[e].call.close())}},{key:"mediaConnection",value:function(e,t){var n=this;t.send({author:this.id,type:"text",data:{text:"Request media connection..."}}),navigator.mediaDevices.getUserMedia(this.constraints).then((function(t){n.peerNotify["stream"](t,"localVideo");var o=n.call(e,t);n.peerNotify["call"](o,"offer"),o.on("stream",(function(e){n.peerNotify["stream"](e,"remotevideo"),n.connecters[o.peer].call=o})).on("close",(function(){console.log("Media call closed"),n.connecters[o.peer].call=void 0})).on("error",(function(){console.error("Failed media call",err),n.connecters[o.peer].call=void 0}))})).catch((function(e){console.error("Failed to get local stream",e)}))}},{key:"updatePeers",value:function(){var e=this;this.listAllPeers((function(t){console.debug("Connected peers: ",t),e.peerNotify&&e.peerNotify.hasOwnProperty("peers")&&e.peerNotify["peers"](t)}))}}]),n}(P.a),j=n("7f30"),k={name:"app",components:{VideoArea:h,SideMenu:b},data:function(){return{contact:void 0,title:"Lobby",participants:[],titleImageUrl:"https://vcomm.github.io/cloudnav/images/eyes-on.png",messageList:[{type:"text",author:"Sales",data:{text:j.welcome}}],newMessagesCount:0,isChatOpen:!1,showTypingIndicator:"",colors:null,availableColors:C,chosenColor:null,alwaysScrollToBottom:!0,messageStyling:!0,userIsTyping:!1,comChannel:null,isVideo:!1,inCall:!1}},created:function(){var e=this;this.setColor(j.theme),window.addEventListener("beforeunload",(function(t){return e.comChannel&&(e.comChannel.disconnect(),e.comChannel.destroy()),null}))},methods:{callOn:function(){this.comChannel&&(this.inCall||(this.isVideo=!0,this.inCall=!0,this.comChannel.callToPeer(this.contact)))},callOff:function(){this.comChannel&&this.inCall&&(this.comChannel.hangUpPeer(this.contact),this.inCall=!1,this.isVideo=!1)},stopUserMedia:function(){var e=document.querySelector("#localVideo").srcObject;e&&e.getTracks().forEach((function(e){return e.stop()})),document.querySelector("#localVideo").srcObject=null},videoShow:function(){this.isVideo=!this.isVideo,console.log("Show video: ".concat(this.isVideo))},createChannel:function(){var e=this,t=this,n="super"===j.type?j.id:j.id+Math.floor(Math.random()*Math.pow(2,18)).toString(36).padStart(4,0);this.comChannel=new L(n,j.peer,{data:function(t){e.newMessagesCount=e.isChatOpen?e.newMessagesCount:e.newMessagesCount+1,e.onMessageWasSent(t)},call:function(t,n){console.log("Call ".concat(n," to peer:"),t),e.isVideo=!0},peers:function(e){console.log("Update connection peers",e),e.forEach((function(e){t.updateParticipants(e)}))},stream:function(t,n){console.log("".concat(n," peer stream:"),t),e.isVideo=!0,document.querySelector("#".concat(n)).srcObject=t}}),this.ttlUpdate()},onSelect:function(e){console.log("Selected: ".concat(e.target.value),this.contact)},updateParticipants:function(e){this.comChannel.id!==e&&(this.participants=[].concat(Object(a["a"])(this.participants),[{id:e,name:"Guest ".concat(e),imageUrl:"https://vcomm.github.io/cloudnav/images/logo.jpg"}]))},sendMessage:function(e){e.length>0&&(this.newMessagesCount=this.isChatOpen?this.newMessagesCount:this.newMessagesCount+1,this.onMessageWasSent({author:"Support",type:"text",data:{text:e}}))},onMessageWasSent:function(e){if(this.comChannel){if("me"===e.author&&void 0!==this.contact)console.log("Me PeerID: ".concat(this.comChannel.id," was send message:"),e),this.comChannel.msgToPeer({author:this.comChannel.id,type:e.type,data:e.data},this.contact);else{if("me"===e.author&&void 0===this.contact)return void(this.messageList=[].concat(Object(a["a"])(this.messageList),[{type:"text",author:"Support",data:{text:"Cannot send the msg => ".concat(this.contact)}}]));void 0===this.contact&&"me"!==e.author?(this.contact=e.author,"Request media connection..."===e.data.text&&this.callOn()):"me"!==e.author&&"HangUp media connection..."===e.data.text&&this.callOff()}this.messageList=[].concat(Object(a["a"])(this.messageList),[e])}else this.messageList=[].concat(Object(a["a"])(this.messageList),[{type:"text",author:"Support",data:{text:"Communication with peer signaling Failed!"}}])},openChat:function(){this.isChatOpen=!0,this.newMessagesCount=0,this.comChannel?this.comChannel.reconnect():this.createChannel()},closeChat:function(){this.isChatOpen=!1,this.comChannel&&this.comChannel.disconnect()},setColor:function(e){this.colors=this.availableColors[e],this.chosenColor=e},handleScrollToTop:function(){},handleOnType:function(){console.log("Emit typing event =>",this.contact)},editMessage:function(e){var t=this.messageList.find((function(t){return t.id===e.id}));t.isEdited=!0,t.data.text=e.data.text},removeMessage:function(e){var t=this.messageList.find((function(t){return t.id===e.id}));t.type="system",t.data.text="This message has been removed"},ttlUpdate:function(){var e=this;setInterval((function(){e.comChannel&&(e.participants=[],e.comChannel.updatePeers())}),1e4)},msgWelcome:function(){var e=this;setTimeout((function(){e.newMessagesCount=e.isChatOpen?e.newMessagesCount:e.newMessagesCount+1,e.messageList=[].concat(Object(a["a"])(e.messageList),[{type:"text",author:"Assistant",data:{text:"Hello! What can I help you?"}}])}),3e4)}},computed:{linkColor:function(){return"dark"===this.chosenColor?this.colors.sentMessage.text:this.colors.launcher.bg},backgroundColor:function(){return"dark"===this.chosenColor?this.colors.messageList.bg:"#fff"}},mounted:function(){this.messageList.forEach((function(e){return e.liked=!1})),this.msgWelcome()}},V=k,T=(n("034f"),Object(d["a"])(V,s,i,!1,null,null,null)),N=T.exports,E=n("e54b"),U=n.n(E);o["default"].use(U.a),o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(N)}}).$mount("#app")},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"},"7f30":function(e){e.exports=JSON.parse('{"id":"guest-","type":"master","peer":{"key":"peerjs","host":"192.168.1.109","port":443,"debug":1,"path":"/myapp","config":{"iceServers":[{"url":"stun:stun01.sipphone.com"},{"url":"stun:stun.ekiga.net"},{"url":"stun:stun.fwdnet.net"},{"url":"stun:stun.ideasip.com"},{"url":"stun:stun.iptel.org"},{"url":"stun:stun.rixtelecom.se"},{"url":"stun:stun.schlund.de"},{"url":"stun:stun.l.google.com:19302"},{"url":"stun:stun1.l.google.com:19302"},{"url":"stun:stun2.l.google.com:19302"},{"url":"stun:stun3.l.google.com:19302"},{"url":"stun:stun4.l.google.com:19302"},{"url":"stun:stunserver.org"},{"url":"stun:stun.softjoys.com"},{"url":"stun:stun.voiparound.com"},{"url":"stun:stun.voipbuster.com"},{"url":"stun:stun.voipstunt.com"},{"url":"stun:stun.voxgratia.org"},{"url":"stun:stun.xten.com"},{"url":"turn:numb.viagenie.ca","credential":"muazkh","username":"webrtc@live.com"},{"url":"turn:192.158.29.39:3478?transport=udp","credential":"JZEOEt2V3Qb0y27GRntt2u2PAYA=","username":"28224511:1379330808"},{"url":"turn:192.158.29.39:3478?transport=tcp","credential":"JZEOEt2V3Qb0y27GRntt2u2PAYA=","username":"28224511:1379330808"}],"sdpSemantics":"unified-plan"}},"theme":"dark","welcome":"Welcome to our Website!","services":{"Assistant":{"id":"Assistant","name":"Cloud Personal Assistant AI","imageUrl":"https://vcomm.github.io/cloudnav/images/eyes-on.png"},"Sales":{"id":"Sales","name":"Cloud Navigator Sales Consultant","imageUrl":"https://vcomm.github.io/cloudnav/images/logo.jpg"},"Support":{"id":"Support","name":"Cloud Navigator Techical Support","imageUrl":"https://avatars3.githubusercontent.com/u/37018832?s=200&v=4"}}}')},"85ec":function(e,t,n){},aa28:function(e,t,n){"use strict";n("f8dd")},e137:function(e,t,n){},f8dd:function(e,t,n){},faa2:function(e,t,n){"use strict";n("e137")}});
//# sourceMappingURL=app.8bbd5874.js.map